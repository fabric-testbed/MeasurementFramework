filebeat.inputs:
{% if elk_destination == 'ODC' %}
  {% if hostname in ODC.AM_logs_to_monitor %}
  - type: filestream
    enabled: true
    id: {{ hostname }}
    paths:
       - /home/nrig-service/ControlFramework/fabric_cf/*/*/logs/*.log
  {% elif hostname.startswith('uis.') %}
  - type: filestream
    enabled: true
    id: {{ hostname }}
    paths:
       - /home/nrig-service/fabric-core-api/logs/metrics/core-api-metrics.log
  {% elif hostname.startswith('cm.') %}
  - type: filestream
    enabled: true
    id: {{ hostname }}
    paths:
       - /home/nrig-service/CredentialManager/log/credmgr/credmgr.log

  {% endif %}
{% endif %}

{% if component_type == 'head' %}
  - type: filestream
    enabled: true
    id: {{ hank_name }}-am
    paths:
       - /home/nrig-service/ControlFramework/fabric_cf/authority/{{ hank_name }}-am/logs/*.log

  - type: filestream
    enabled: true
    id: {{ hank_name }}-data-sw
    paths:
       - /var/log/remote/192.168.{{ hank_id }}.3/*.log

  - type: filestream
    enabled: true
    id: {{ hank_name }}-mgt-sw
    paths:
       - /var/log/remote/192.168.{{ hank_id }}.2/*.log

  - type: filestream
    enabled: true
    id: {{ hank_name }}-vpn
    paths:
       - /var/log/remote/192.168.{{ hank_id }}.1/*.log

  - type: filestream
    enabled: true
    id: {{ hank_name }}-storage
    paths:
       - /var/log/remote/192.168.{{ hank_id }}.110/*.log
       - /var/log/remote/192.168.{{ hank_id }}.111/*.log

{% endif %}

  - type: filestream
    enabled: true
    id: {{ hank_name }}-nova
    paths:
       - /var/log/nova/*.log

  - type: filestream
    enabled: true
    id: linuxptp
    paths:
       - /var/log/ptp4l.log
       - /var/log/phc2sys.log

filebeat.modules:
  - module: system
    syslog:
      enabled: {{ system_enable }}
      var.paths: ["/var/log/messages"]
      var.convert_timezone: false
    auth:
      enabled: {{ system_enable }}
      var.paths: ["/var/log/secure*"]
      var.convert_timezone: false

setup.template.settings:
  index.number_of_shards: 1

# -------------------------------- Kafka Output --------------------------------
output.kafka:
  enabled: true
  hosts: "{{ hostvars[inventory_hostname][elk_destination]['mfkfk_hosts'] }}"
  topic: "{{ hostvars[inventory_hostname][elk_destination]['mfkfk_topic_name'] }}"
  username: "{{ hostvars[inventory_hostname][elk_destination]['mfkfk_username'] }}"
  password: "{{ hostvars[inventory_hostname][elk_destination]['mfkfk_password'] }}"
  sasl.mechanism: SCRAM-SHA-256
  ssl.verification_mode: certificate
  ssl.certificate_authorities: "{{ hostvars[inventory_hostname][elk_destination]['ssl']['certificate_authorities'] }}"

processors:
  - add_host_metadata:
      when.not.contains.tags: forwarded
  - add_cloud_metadata: ~
  - add_docker_metadata: ~
  - add_kubernetes_metadata: ~
